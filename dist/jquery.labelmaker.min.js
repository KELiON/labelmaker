!function(t){t.fn.labelmaker=function(e,n){function o(e){return e.children().map(function(){return{top:t(this).data("top"),left:t(this).data("left"),text:t(this).html()}}).toArray()}function i(t,e){e.forEach(function(e){t.append('<div class="labelmaker-point" style="top:'+e.top+"%; left:"+e.left+'%;"></div>').append('<div class="labelmaker-bubble"><div class="labelmaker-bubble-inner">'+e.text+"</div></div>")})}function l(t){t.find(".labelmaker-point, .labelmaker-bubble").remove()}function a(t){t.find(".labelmaker-bubble").removeClass("active").removeAttr("style")}function r(e){e.on("DOMMouseScroll mousewheel",function(e){var n=t(this),o=this.scrollTop,i=this.scrollHeight,l=n.outerHeight(),a="DOMMouseScroll"==e.type?-40*e.originalEvent.detail:e.originalEvent.wheelDelta,r=a>0,c=function(){return e.stopPropagation(),e.preventDefault(),e.returnValue=!1,!1};return!r&&-a>i-l-o?(n.scrollTop(i),c()):r&&a>o?(n.scrollTop(0),c()):void 0})}function c(e,n,o,i){var l,a=e.outerWidth(),c=e.position(),u=n.outerHeight(),s=n.outerWidth(),h=i-c.top-a,b=o-c.left-a,f=c.top+a,p=c.left+a;u>h&&(l=-1*(i-f-u),f=f-l-a/2),s>b&&(l=-1*(o-p-s),p=p-l-a/2),n.css({top:f,left:p}).addClass("active"),u<n.find(".labelmaker-bubble-inner").prop("scrollHeight")&&(n.addClass("scrollable"),r(t(".scrollable .labelmaker-bubble-inner")))}function u(n){function r(e,n){e.stopPropagation(),e.preventDefault(),a(f),$bubble=t(n).next(),$point=t(n),c($point,$bubble,h,b)}function u(){f.removeAttr("style"),h=n.width(),b=n.height(),f.width(h).height(b),l(f),i(f,p)}var h=n.width(),b=n.height();n.wrap('<div class="labelmaker-container" />');var f=n.parent(".labelmaker-container");f.width(h).height(b),e.hide();var p=o(e);i(f,p),"hover"===s.showOn?f.on({"click touchstart mouseenter":function(t){r(t,this)},mouseleave:function(){a(f)}},".labelmaker-point"):f.on("click touchstart",".labelmaker-point",function(t){r(t,this)}),f.on("click touchstart",".labelmaker-bubble",function(t){t.stopPropagation()}),t(document).on("click",function(){a(f)});var d;t(window).on("resize orientationChanged",function(){clearTimeout(d),d=setTimeout(u,100)})}var s=t.extend({showOn:"click"},n);return this.each(function(){var e=t(this);e.one("load",function(){u(e)}).each(function(){this.complete&&t(this).load()})})}}(jQuery);